/* Sakura theme */
:root {
  --bg: #fff6f8;
  --ink: #2a1d22;
  --accent: #ff7aa2;
  --accent-dark: #ff4d85;
  --envelope: #fff1f4;
  --envelope-edge: #ffd8e4;
  --paper: #ffffff;
  --shadow: 0 20px 50px rgba(0,0,0,.12);
}

* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  color: var(--ink);
  background: radial-gradient(1200px 800px at 70% -10%, #ffe9f1 0%, transparent 70%),
              radial-gradient(900px 700px at -20% 110%, #fff0f5 0%, transparent 65%),
              var(--bg);
}

.page { min-height: 100dvh; display: grid; place-items: center; padding: 24px; }
.scene { display: grid; gap: 16px; place-items: center; }
.hint { margin: 0; color: #b07b89; font-size: 14px; }

.envelope { position: relative; width: 760px; height: 420px; background: transparent; border: 0; padding: 0; cursor: pointer; perspective: 1000px; filter: drop-shadow(var(--shadow)); will-change: transform; }
.envelope:focus-visible { outline: 2px solid var(--accent); outline-offset: 6px; }
.envelope-tilt { width: 100%; height: 100%; transform-style: preserve-3d; transform: rotateX(0) rotateY(0); transition: transform 180ms ease-out; }

.base { position: absolute; inset: 0; background: linear-gradient(180deg, var(--envelope) 0%, #ffe9f1 100%); border-radius: 14px; overflow: hidden; z-index: 1; }
.lid { position: absolute; left: 0; right: 0; top: 0; height: 62%; transform-origin: top center; background: linear-gradient(180deg, var(--envelope-edge), var(--envelope)); clip-path: polygon(0 0, 100% 0, 50% 100%); border-top-left-radius: 14px; border-top-right-radius: 14px; z-index: 3; transition: transform .7s cubic-bezier(.2,.7,.2,1); backface-visibility: hidden; transform-style: preserve-3d; }
.seal { position: absolute; top: 48%; left: 50%; transform: translate(-50%, -50%); width: 84px; height: 84px; background: radial-gradient(circle at 30% 30%, #ffb2c9, var(--accent)); border-radius: 50%; z-index: 4; box-shadow: 0 10px 20px rgba(233,122,161,.35); display: grid; place-items: center; transition: transform .5s ease, opacity .5s ease; overflow: visible; }
.heart { color: white; font-size: 30px; line-height: 1; }

.paper { position: absolute; left: 8%; right: 8%; bottom: 12%; height: 80%; background: var(--paper); border-radius: 10px; transform: translateY(20%) rotateX(10deg); transform-origin: bottom center; z-index: 5; overflow: hidden; box-shadow: 0 12px 30px rgba(0,0,0,.08); transition: transform .7s cubic-bezier(.2,.7,.2,1), opacity .4s ease; opacity: 0; pointer-events: none; backface-visibility: hidden; }
.letter-inner { padding: 28px 26px 30px; height: 100%; overflow: auto; font-family: "Playfair Display", Georgia, serif; font-size: 20px; -webkit-overflow-scrolling: touch; }
.letter-inner h1 { margin: 0 0 8px; font-size: 34px; letter-spacing: .5px; }
.letter-inner p { margin: 10px 0; line-height: 1.7; }
.signature { margin-top: 12px; font-style: italic; opacity: .8; }

.envelope.open .lid { transform: rotateX(180deg); }
.envelope.open .seal { transform: translate(-50%, -50%) scale(.6); opacity: .2; }
.envelope.open .paper { transform: translateY(-35%) rotateX(0deg); z-index: 6; opacity: 1; pointer-events: auto; }

/* Click bounce */
.envelope.is-bouncing { animation: envelope-bounce 700ms cubic-bezier(.34,1.56,.64,1) both; }
@keyframes envelope-bounce { 0% { transform: translateY(-18px) scale(.98); } 55% { transform: translateY(0) scale(1.04); } 75% { transform: translateY(-8px) scale(1.01); } 100% { transform: translateY(0) scale(1); } }
@media (prefers-reduced-motion: reduce) { .envelope.is-bouncing { animation: none; } }

/* Small screens */
@media (max-width: 420px) {
  .envelope { width: 340px; height: 240px; }
  .heart { font-size: 26px; }
  .seal { width: 72px; height: 72px; }
  .letter-inner { font-size: 18px; padding: 22px 20px 26px; }
  .letter-inner h1 { font-size: 28px; }
}

/* Remove list numbering/bullets inside the letter */
.letter-inner ol,
.letter-inner ul {
  list-style: none;
  padding-left: 0;
  margin: 0;
}

.letter-inner li { margin: 8px 0; }


/* Sakura petals */
.petal {
  position: fixed;
  top: -12vh;
  left: 0;
  width: var(--size);
  height: var(--size);
  pointer-events: none;
  z-index: 0;
  transform: translate(var(--startX), -12vh);
  animation: petal-fall var(--duration) linear forwards, petal-flip var(--flipDuration) ease-in-out infinite;
  filter: drop-shadow(0 6px 12px rgba(0,0,0,.12));
}

.petal .shape {
  width: 100%;
  height: 120%;
  transform-origin: 50% 10%;
  transform: rotate(var(--initialRot));
  animation: petal-sway var(--swayDuration) ease-in-out infinite alternate;
  background: radial-gradient(circle at 35% 30%, var(--petalLight), var(--petalMid) 60%, var(--petalDark) 100%);
  border-radius: 60% 60% 70% 70% / 70% 70% 80% 80%;
}

.petal .shape::after {
  content: "";
  position: absolute;
  top: 18%; left: 28%;
  width: 32%; height: 20%;
  background: radial-gradient(circle, rgba(255,255,255,.65), rgba(255,255,255,0) 70%);
  transform: rotate(-20deg);
  border-radius: 50%;
}

@keyframes petal-fall {
  to { transform: translate(calc(var(--startX) + var(--driftX)), 110vh); opacity: 0.98; }
}

@keyframes petal-sway {
  from { transform: rotate(calc(var(--initialRot) - var(--swayAngle))); }
  to   { transform: rotate(calc(var(--initialRot) + var(--swayAngle))); }
}

@keyframes petal-flip {
  0%, 100% { filter: brightness(1) saturate(1); }
  50% { filter: brightness(1.05) saturate(1.1); }
}

@media (prefers-reduced-motion: reduce) {
  .petal { display: none; }
}

